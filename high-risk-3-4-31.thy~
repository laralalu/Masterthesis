theory "high-risk-3-4-31"
  imports 
  types
  SDL_agents
begin

(*agent e = conformity assessment body*) 
(*agent f = notifying authority*)
(*agent g = notified body*)

consts
  notifying_authority_sys::agent
  conform_ass_body::"agent\<Rightarrow>\<sigma>" (*conformity assessment body*)
  submit_appl_notific::"agent\<Rightarrow>agent\<Rightarrow>\<sigma>"
  accr_cert_exists_Art33::"agent\<Rightarrow>\<sigma>"
  appl_accompanied_by_descrip::"agent\<Rightarrow>\<sigma>"
  appl_accompanied_by_accr_cert_Art33::"agent\<Rightarrow>\<sigma>"
  appl_add_rel_doc::"agent\<Rightarrow>\<sigma>"
  appl_provide_evidence_comp_Art33::"agent\<Rightarrow>\<sigma>"
  notified_body_designated_other_Union_harm_leg::"agent\<Rightarrow>\<sigma>" 
  use_docs_linked_to_other_designations::"agent\<Rightarrow>\<sigma>"

abbreviation "A1 \<equiv> \<lfloor>\<^bold>\<circle>e<stite (submit_appl_notific f e)>\<rfloor>"
abbreviation "A2 \<equiv> \<lfloor>\<^bold>\<circle>e<stite (appl_accompanied_by_descrip e)>\<rfloor>"
abbreviation "A3 \<equiv> \<lfloor>\<^bold>\<circle>e<stite (appl_add_rel_doc e)>\<rfloor>"

(*two cases:*)
abbreviation "A4 \<equiv> \<lfloor>(accr_cert_exists_Art33 e \<^bold>\<rightarrow> \<^bold>\<circle>e<stite (appl_accompanied_by_accr_cert_Art33 e)>)\<rfloor>"
abbreviation "A5 \<equiv> \<lfloor>(\<^bold>\<not> accr_cert_exists_Art33 e \<^bold>\<rightarrow> \<^bold>\<circle>e<stite (appl_provide_evidence_comp_Art33 e)>)\<rfloor>"

(*not obligated to not do something \<rightarrow> may*)
abbreviation "A6 \<equiv> \<lfloor>(notified_body_designated_other_Union_harm_leg g) \<^bold>\<rightarrow>
   \<^bold>\<not>\<^bold>\<circle>g<\<^bold>\<not> (stitg (use_docs_linked_to_other_designations g))>\<rfloor>"
abbreviation "theory \<equiv> A1 \<and> A2 \<and> A3 \<and> A4 \<and> A5 \<and> A6"

(*Facts*)
consts b::agent c::agent
abbreviation "F1 w \<equiv> (accr_cert_exists_Art33 b)  w"
abbreviation "F2 w \<equiv> (notified_body_designated_other_Union_harm_leg b) w"
abbreviation "F3 w \<equiv> (\<^bold>\<not> (accr_cert_exists_Art33 c))  w"
abbreviation "F4 w \<equiv> (\<^bold>\<not> (notified_body_designated_other_Union_harm_leg c)) w"
abbreviation "facts \<equiv> F1 \<^bold>\<and> F2 \<^bold>\<and> F3 \<^bold>\<and> F4"

theorem Result1a: "theory \<longrightarrow> \<lfloor>facts \<^bold>\<rightarrow> (\<^bold>\<circle>e<stite (appl_accompanied_by_accr_cert_Art33 b)>)\<rfloor>"  
  by auto

theorem Result1b: "theory \<longrightarrow> \<lfloor>facts \<^bold>\<rightarrow> (\<^bold>\<circle>e<stite (appl_accompanied_by_accr_cert_Art33 c)>)\<rfloor>"  
  nitpick [user_axioms] (*counterexample found*) oops

theorem Result2a: "theory \<longrightarrow> \<lfloor>facts \<^bold>\<rightarrow> (\<^bold>\<not>\<^bold>\<circle>e<\<^bold>\<not> (stite (use_docs_linked_to_other_designations b))>)\<rfloor>"  
  by auto

theorem Result2b: "theory \<longrightarrow> \<lfloor>facts \<^bold>\<rightarrow> (\<^bold>\<not>\<^bold>\<circle>e<\<^bold>\<not> (stite (use_docs_linked_to_other_designations c))>)\<rfloor>"  
  nitpick [user_axioms] (*counterexample found*) oops

end